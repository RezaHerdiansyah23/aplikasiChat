<!DOCTYPE html>
<html>
<head>
    <title>chat apllication</title>
    <style>
        form {
  position: absolute;
  bottom: 0;
  width: 100%;
  background: grey;
  padding: 20px;
}
li {
    padding: 5px;
}
li:nth-child(even){
    background: #333;
    color: rgb(255, 250, 250);
}
#nama_user {
  float: left;
  width: 20%;
  height: 30px;
  border: none;
 
}
#text_box {
  float: left;
  width: 40%;
  height: 30px;
  border: none;
  margin-left: 10px;
}

button {
  float: left;
  width: 20%;
  height: 33px;
}
.hidden{
    display: none;
}

    </style>
</head>
<body>
    <div id="hompage">
        <h1>Selamat Datang di chatroom</h1>
        <input type="text" id="nama_user" placeholder="nama user">
        <button id="submit_name">Masuk !</button>
    </div>

<div id="chatroom" class="hidden">
    <ul id="messages"></ul>
    <form>
        <input type="text" id="text_box" placeholder="chat kamu"><button>Send</button>
    </form>
    </div>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        var socket = io();
        var username = '';
        $('form').submit(function(){
            username = $('#nama_user').val();
            socket.emit('newMessage', username + ' ' + $('#text_box').val());
            $('#text_box').val('');
            return false;
        });
        socket.on('newMessage', function(msg){
            $('#messages').append($('<li>').text(msg +' ||pada:'+Date()));
        });
        $('#submit_name').click(function(){
           if($('#nama_user') != ''){
            //menguji nama susdah ada atau belum
            username = $('#nama_user').val();
            socket.emit('registerUser', username);
           }
        });

        //menerima respond
        socket.on('registerRespond', function(status){
            if(status == false){
                alert('nama user sudah ada');
            }else {
                $('#chatroom').removeClass('hidden');
                $('#hompage').addClass('hidden');
            }
        })

       
    </script>
</body>
</html>